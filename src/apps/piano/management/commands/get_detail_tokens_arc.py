# -*- coding: utf-8 -*-

from django.conf import settings
from django.core.management.base import BaseCommand
from django.db.models import Q
from sentry_sdk import capture_exception

from apps.paywall.models import Operation, Subscription
from apps.siebel.models import SiebelConfiguration, ReasonExclude, LoadTransactionsIdSiebel, SiebelConfirmationPayment, \
    SubscriptionExclude
from datetime import datetime, timedelta
from django.db.models import Count
from apps.paywall.arc_clients import SalesClient
from django.utils.encoding import smart_str
import csv
import time
from apps.piano.piano_clients import VXClient
from apps.arcsubs.utils import timestamp_to_datetime


class Command(BaseCommand):
    help = 'Ejecuta el comando'

    def add_arguments(self, parser):
        parser.add_argument('--site', nargs='?', type=str)
        parser.add_argument('--rama', nargs='?', type=str)

    def handle(self, *args, **options):
        """
            - Genera el csv AID_psc_subs.csv para la migracion de terminos de pago
            - python3 manage.py migration_subscriptions --site gestion --rama sandbox
        """

        suscription_list = [
            '5241849176358963',
            '7145120071016474',
            '3661722797992547',
            '7292177743238508',
            '8814100779837368',
            '3305075411656172',
            '7731261099749120',
            '6087394210161153',
            '5179311608728695',
            '5241849176358964',
            '7145120071016475',
            '3661722797992548',
            '7292177743238509',
            '8814100779837369',
            '3305075411656173',
            '7731261099749121',
            '6087394210161154',
            '5179311608728696',
            '5241849176358965',
            '7145120071016476',
            '3661722797992549',
            '7292177743238510',
            '8814100779837370',
            '3305075411656174',
            '7731261099749122',
            '6087394210161155',
            '5179311608728697',
            '5241849176358966',
            '7145120071016477',
            '3661722797992550',
            '7292177743238511',
            '8814100779837371',
            '3305075411656175',
            '7731261099749123',
            '6087394210161156',
            '5179311608728698',
            '5241849176358967',
            '7145120071016478',
            '3661722797992551',
            '7292177743238512',
            '8814100779837372',
            '3305075411656176',
            '7731261099749124',
            '6087394210161157',
            '5179311608728699',
            '5241849176358968',
            '7145120071016479',
            '3661722797992552',
            '7292177743238513',
            '8814100779837373',
            '3305075411656177',
            '7731261099749125',
            '6087394210161158',
            '5179311608728700',
            '5241849176358969',
            '7145120071016480',
            '3661722797992553',
            '7292177743238514',
            '8814100779837374',
            '3305075411656178',
            '7731261099749126',
            '6087394210161159',
            '5179311608728701',
            '5241849176358970',
            '7145120071016481',
            '3661722797992554',
            '7292177743238515',
            '8814100779837375',
            '3305075411656179',
            '7731261099749127',
            '6087394210161160',
            '5179311608728702',
            '5241849176358971',
            '7145120071016482',
            '3661722797992555',
            '7292177743238516',
            '8814100779837376',
            '3305075411656180',
            '7731261099749128',
            '6087394210161161',
            '5179311608728703',
            '5241849176358972',
            '7145120071016483',
            '3661722797992556',
            '7292177743238517',
            '8814100779837377',
            '3305075411656181',
            '7731261099749129',
            '6087394210161162',
            '5179311608728704',
            '5241849176358973',
            '7145120071016484',
            '3661722797992557',
            '7292177743238518',
            '8814100779837378',
            '3305075411656182',
            '7731261099749130',
            '6087394210161163',
            '5179311608728705',
            '5241849176358974',
            '7145120071016485',
            '3661722797992558',
            '7292177743238519',
            '8814100779837379',
            '3305075411656183',
            '7731261099749131',
            '6087394210161164',
            '5179311608728706',
            '5241849176358975',
            '7145120071016486',
            '3661722797992559',
            '7292177743238520',
            '8814100779837380',
            '3305075411656184',
            '7731261099749132',
            '6087394210161165',
            '5179311608728707',
            '5241849176358976',
            '7145120071016487',
            '3661722797992560',
            '7292177743238521',
            '8814100779837381',
            '3305075411656185',
            '7731261099749133',
        ]
        for subs in suscription_list:
            try:
                data_subscription = SalesClient().get_subscription(
                    site='elcomercio',
                    subscription_id=subs
                )
                print(data_subscription)
            except:
                pass



